<!DOCTYPE html>
<html>
<script src="jquery-3.2.1.min.js"></script>
<script src="sigma.min.js"></script>
<script type="text/javascript">

var testMap = "../maps/sample.json";
var sWrap;

var colors = ["#cc0000", "#00cc00", "#0000cc", "aaaa00", "aa00aa", "00aaaa"];

function initGame(players) {
    for (var i in players) {
        var row =
            $("<tr>")
                .append($("<td>").append($("<font>").attr("color", colors[i]).text(players[i])))
                .append($("<td>").text(0));
        $("#scoreboard").after(row);
    }
}

function claim(player, river) {
    sWrap.graph.edges(river).color = colors[player];
    sWrap.refresh();
}

function mapToSigma(obj) {
    var res = {"nodes": obj.sites, "edges": obj.rivers};
    for (var n of res.nodes) {
        n.size = 2;
        n.color = "#000000";
    }
    for (var i in res.edges)
        res.edges[i].id = i;
    return res;
}

function loadGraph(path) {
    $.ajax({
        url: path,
        success: function(response) {
            sWrap.graph.clear();
            sWrap.graph.read(mapToSigma(response));
            sWrap.refresh();
        }
    });
}

$(function() {
    $(':button').on('click', function() {
        loadGraph("../maps/" + $("#file").val() + ".json");
    });
    sWrap = new sigma("graph-container");
    initGame(["player1", "player2"])
    loadGraph(testMap);
});

</script>
<head>
    <title>LambdaPunt state viewer</title>
</head>
<body>
    <div id="load">
        <form enctype="multipart/form-data" method="post">
            <input id="file" type="text" value="circle"/>
            <input type="button" value="Load"/>
        </form>
    </div>
    <div id="replay">
        <a href="begin">&lt;|</a>&nbsp;
        <a href="#back">&lt;&lt;</a>&nbsp;
        <a href="#forward">&gt;&gt;</a>&nbsp;
        <a href="#end">|&gt;</a>
    </div>
    <style>

    #graph-container {
        max-width: 800px; height: 600px; margin: auto;
    }

    #log {
        max-width: 800px; height: 240px;
        overflow: auto;
    }

  </style>
    <div id="graph-container">
    </div>
    <table><tr>
        <td>
            <table id="scoreboard"><tr><th>Player</th><th>Score</th></tr></table>
        </td>
        <td>
            <div id="log"></div>
        </td>
    </tr></table>
</body>
</html>
